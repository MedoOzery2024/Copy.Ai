<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Copy.Ai - تلخيص واستخراج النصوص</title>
    <meta name="description" content="أداة متطورة لاستخراج وتلخيص النصوص من الصور والمستندات">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="hero">
        <div class="container">
            <div class="hero-content">
                <div class="hero-icon">
                    <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                </div>
                <h1 class="hero-title">Copy.Ai</h1>
                <p class="hero-subtitle">استخراج وتلخيص النصوص بذكاء</p>
                <p class="hero-description">استخرج النصوص من الصور والمستندات وقم بتلخيصها تلقائياً بنسخة واحدة</p>
            </div>
        </div>
    </header>

    <main class="container">
        <div class="tabs">
            <button class="tab-btn active" data-tab="image">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path>
                    <circle cx="12" cy="13" r="4"></circle>
                </svg>
                <span>استخراج من صورة</span>
            </button>
            <button class="tab-btn" data-tab="pdf">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                </svg>
                <span>استخراج من PDF</span>
            </button>
            <button class="tab-btn" data-tab="text">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <polyline points="4 7 4 4 20 4 20 7"></polyline>
                    <line x1="9" y1="20" x2="15" y2="20"></line>
                    <line x1="12" y1="4" x2="12" y2="20"></line>
                </svg>
                <span>تلخيص نص</span>
            </button>
            <button class="tab-btn" data-tab="history">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M3 3v5h5"></path>
                    <path d="M3.05 13A9 9 0 1 0 6 5.3L3 8"></path>
                </svg>
                <span>السجل</span>
            </button>
        </div>

        <div class="tab-content active" id="image-tab">
            <div class="card">
                <div class="controls">
                    <button class="btn btn-primary" onclick="startCamera('user')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path>
                            <circle cx="12" cy="13" r="4"></circle>
                        </svg>
                        الكاميرا الأمامية
                    </button>
                    <button class="btn btn-primary" onclick="startCamera('environment')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path>
                            <circle cx="12" cy="13" r="4"></circle>
                        </svg>
                        الكاميرا الخلفية
                    </button>
                    <button class="btn btn-outline" onclick="document.getElementById('imageInput').click()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="17 8 12 3 7 8"></polyline>
                            <line x1="12" y1="3" x2="12" y2="15"></line>
                        </svg>
                        تحميل صورة
                    </button>
                </div>
                <input type="file" id="imageInput" accept="image/*" style="display: none;">

                <div id="cameraView" style="display: none;">
                    <video id="camera" autoplay></video>
                    <button class="btn btn-primary" onclick="captureImage()" style="margin-top: 1rem; width: 100%;">التقاط الصورة</button>
                </div>

                <div id="imagePreview" style="display: none;">
                    <img id="previewImg" alt="Preview">
                    <button class="btn btn-primary" onclick="extractFromImage()" style="width: 100%; margin-top: 1rem;">استخراج النص</button>
                </div>

                <div id="imageResult" style="display: none;">
                    <div class="result-section">
                        <div class="summary-header">
                            <h3>النص المستخرج:</h3>
                            <button class="btn btn-sm btn-outline" onclick="copyText('extractedImageText')">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                </svg>
                                نسخ
                            </button>
                        </div>
                        <textarea id="extractedImageText" readonly></textarea>
                        <div class="summary-stats">
                            <span id="extractedImageWordCount"></span>
                        </div>
                    </div>

                    <div class="result-section">
                        <div class="summary-header">
                            <h3>الملخص:</h3>
                            <div>
                                <select id="imageSummaryLength" onchange="summarizeExtractedImage()">
                                    <option value="short">قصير (25%)</option>
                                    <option value="medium" selected>متوسط (50%)</option>
                                    <option value="long">مفصل (75%)</option>
                                </select>
                                <button class="btn btn-sm btn-outline" onclick="copyText('imageSummaryText')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                    </svg>
                                    نسخ
                                </button>
                            </div>
                        </div>
                        <textarea id="imageSummaryText" readonly></textarea>
                        <div class="summary-stats">
                            <span id="imageSummaryWordCount"></span>
                            <span id="imageSummaryRatio"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="pdf-tab">
            <div class="card">
                <div class="upload-area" onclick="document.getElementById('pdfInput').click()">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                    <p class="upload-title">اسحب ملف PDF هنا أو انقر للتحميل</p>
                    <p class="upload-subtitle">يدعم ملفات PDF حتى 10MB</p>
                </div>
                <input type="file" id="pdfInput" accept="application/pdf" style="display: none;">

                <div id="pdfPreview" style="display: none;">
                    <div class="file-info">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                        </svg>
                        <div>
                            <p id="pdfFileName"></p>
                            <p id="pdfFileSize"></p>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="extractFromPdf()" style="width: 100%;">استخراج النص</button>
                </div>

                <div id="pdfResult" style="display: none;">
                    <div class="result-section">
                        <div class="summary-header">
                            <h3>النص المستخرج:</h3>
                            <button class="btn btn-sm btn-outline" onclick="copyText('extractedPdfText')">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                </svg>
                                نسخ
                            </button>
                        </div>
                        <textarea id="extractedPdfText" readonly></textarea>
                        <div class="summary-stats">
                            <span id="extractedPdfWordCount"></span>
                        </div>
                    </div>

                    <div class="result-section">
                        <div class="summary-header">
                            <h3>الملخص:</h3>
                            <div>
                                <select id="pdfSummaryLength" onchange="summarizeExtractedPdf()">
                                    <option value="short">قصير (25%)</option>
                                    <option value="medium" selected>متوسط (50%)</option>
                                    <option value="long">مفصل (75%)</option>
                                </select>
                                <button class="btn btn-sm btn-outline" onclick="copyText('pdfSummaryText')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                    </svg>
                                    نسخ
                                </button>
                            </div>
                        </div>
                        <textarea id="pdfSummaryText" readonly></textarea>
                        <div class="summary-stats">
                            <span id="pdfSummaryWordCount"></span>
                            <span id="pdfSummaryRatio"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="text-tab">
            <div class="card">
                <label class="text-label">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <polyline points="4 7 4 4 20 4 20 7"></polyline>
                        <line x1="9" y1="20" x2="15" y2="20"></line>
                        <line x1="12" y1="4" x2="12" y2="20"></line>
                    </svg>
                    النص المراد تلخيصه:
                </label>
                <textarea id="textInput" placeholder="الصق النص هنا..."></textarea>
                <div class="summary-stats">
                    <span id="textWordCount">الكلمات: 0</span>
                    <span id="textCharCount">الأحرف: 0</span>
                </div>
                <div class="select-group">
                    <label>طول التلخيص:</label>
                    <select id="textSummaryLength">
                        <option value="short">قصير (25%)</option>
                        <option value="medium" selected>متوسط (50%)</option>
                        <option value="long">مفصل (75%)</option>
                    </select>
                </div>
                <button class="btn btn-primary" onclick="summarizeText()" style="width: 100%;">تلخيص النص</button>

                <div id="textSummaryResult" style="display: none;">
                    <div class="summary-header">
                        <h3>التلخيص:</h3>
                        <button class="btn btn-sm btn-outline" onclick="copyText('textSummaryText')">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                            </svg>
                            نسخ
                        </button>
                    </div>
                    <textarea id="textSummaryText" readonly></textarea>
                    <div class="summary-stats">
                        <span id="textSummaryWordCount"></span>
                        <span id="textSummaryRatio"></span>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="history-tab">
            <div class="history-actions">
                <button class="btn btn-outline btn-sm" onclick="clearAllHistory()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <polyline points="3 6 5 6 21 6"></polyline>
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                    </svg>
                    مسح الكل
                </button>
            </div>
            <div id="historyList" class="history-list"></div>
            <div id="emptyHistory" class="empty-state">
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                </svg>
                <h3>لا توجد سجلات بعد</h3>
                <p>ابدأ باستخراج أو تلخيص نص لرؤيته هنا</p>
            </div>
        </div>

        <div class="features">
            <div class="feature-card">
                <div class="feature-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                    </svg>
                </div>
                <h3>استخراج تلقائي</h3>
                <p>استخرج النصوص من الصور و PDF بدقة عالية</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                </div>
                <h3>تلخيص ذكي</h3>
                <p>اختصر النصوص الطويلة بنسب مختلفة</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M3 3v5h5"></path>
                        <path d="M3.05 13A9 9 0 1 0 6 5.3L3 8"></path>
                    </svg>
                </div>
                <h3>حفظ السجل</h3>
                <p>الوصول لجميع عمليات الاستخراج والتلخيص</p>
            </div>
        </div>
    </main>

    <div id="toast" class="toast"></div>

    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>
    <script src="script.js"></script>
</body>
</html>
